\usepackage[margin=0.8in]{geometry}
\usepackage{amsmath, amsfonts,mathtools,amsthm,mathrsfs, amssymb}
\usepackage{bbm}
\usepackage{titlesec}
\usepackage{setspace}
\usepackage{changepage}
\usepackage{mathrsfs}
\usepackage{fancyhdr}
\usepackage{titling}
\usepackage{algorithm}
\PassOptionsToPackage{noend}{algpseudocode}
\usepackage{algpseudocode}
\usepackage{hyperref}

%bibtex:
\usepackage{biblatex}
\addbibresource{refs.bib}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{question}[theorem]{Question}

\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{fact}[theorem]{Fact}

%Macros
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\norm}{||}{||}
\DeclarePairedDelimiterX{\inp}[2]{\langle}{\rangle}{#1, #2}


\newcommand{\rank}{\text{rank}}
\newcommand{\opt}{\text{OPT}}
\newcommand{\proj}{\text{proj}}
\renewcommand{\Pr}{\mathbb{P}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\C}{\hat{C}}
\newcommand{\tC}{\Tilde{C}}
\newcommand{\n}{\hat{n}}
\newcommand{\E}{\mathbb{E\ }}
\newcommand{\Var}{\text{Var }}
\newcommand{\Geom}{\text{Geom}}
\newcommand{\e}{\mathcal{E}}
\newcommand{\X}{\mathcal{X}}

\renewcommand{\det}[1]{\text{det}\left(#1\right)}
\newcommand{\ind}[1]{\mathbbm{1}_{\{\text{#1}\}}}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\vspan}[1]{\text{span}\left(#1\right)}


%Author & title
\author{Vasily Ilin}

%Set no indent for the whole document
\setlength\parindent{0pt}

%increase spacing between lines
\doublespacing






% set up lines for algorithmicx
\usepackage{etoolbox}
\usepackage{tikz}
\usetikzlibrary{tikzmark}
\usetikzlibrary{calc}

\errorcontextlines\maxdimen

% begin vertical rule patch for algorithmicx (http://tex.stackexchange.com/questions/144840/vertical-loop-block-lines-in-algorithmicx-with-noend-option)
% note that some of the packages above are also needed
\newcommand{\ALGtikzmarkcolor}{black}% customise this, if you want
\newcommand{\ALGtikzmarkextraindent}{4pt}% customise this, if you want
\newcommand{\ALGtikzmarkverticaloffsetstart}{-.5ex}% customise this, if you want
\newcommand{\ALGtikzmarkverticaloffsetend}{-.5ex}% customise this, if you want
\makeatletter
\newcounter{ALG@tikzmark@tempcnta}

\newcommand\ALG@tikzmark@start{%
    \global\let\ALG@tikzmark@last\ALG@tikzmark@starttext%
    \expandafter\edef\csname ALG@tikzmark@\theALG@nested\endcsname{\theALG@tikzmark@tempcnta}%
    \tikzmark{ALG@tikzmark@start@\csname ALG@tikzmark@\theALG@nested\endcsname}%
    \addtocounter{ALG@tikzmark@tempcnta}{1}%
}

\def\ALG@tikzmark@starttext{start}
\newcommand\ALG@tikzmark@end{%
    \ifx\ALG@tikzmark@last\ALG@tikzmark@starttext
        % ignore this, the block was opened then closed directly without any other blocks in between (so just a \State basically)
        % don't draw a vertical line here
    \else
        \tikzmark{ALG@tikzmark@end@\csname ALG@tikzmark@\theALG@nested\endcsname}%
        \tikz[overlay,remember picture] \draw[\ALGtikzmarkcolor] let \p{S}=($(pic cs:ALG@tikzmark@start@\csname ALG@tikzmark@\theALG@nested\endcsname)+(\ALGtikzmarkextraindent,\ALGtikzmarkverticaloffsetstart)$), \p{E}=($(pic cs:ALG@tikzmark@end@\csname ALG@tikzmark@\theALG@nested\endcsname)+(\ALGtikzmarkextraindent,\ALGtikzmarkverticaloffsetend)$) in (\x{S},\y{S})--(\x{S},\y{E});%
    \fi
    \gdef\ALG@tikzmark@last{end}%
}



% the following line injects our new tikzmarking code
\apptocmd{\ALG@beginblock}{\ALG@tikzmark@start}{}{\errmessage{failed to patch}}
\pretocmd{\ALG@endblock}{\ALG@tikzmark@end}{}{\errmessage{failed to patch}}
\makeatother
% end vertical rule patch for algorithmicx
